{
    "collab_server" : "",
    "contents" : "# The dataset credit contains information about the bank customers.\n# It is used to identify whether a customer who applied for the\n# loan will default or not.\n\n#1. Load credit data into R. Make sure the categorical\n# variables are factored. Create testing and training \n# datasets, so that 80% of data goes to train and the rest\n# goes to test.Make sure the proportions of the dependent \n# variable are fixed. Set the seed to 2016. (7)\ncredit_data <- read.csv(file = \"Homework7/data/Credit.csv\", header = TRUE)\ncredit_data$ed <- as.factor(credit_data$ed)\ncredit_data$default <- as.factor(credit_data$default)\n\nlibrary(caret)\nset.seed(2016)\ntrainIndex <- createDataPartition(credit_data$default, p=0.8, list = FALSE)\n\ncredit_training <- credit_data[trainIndex,]\ncredit_testing <- credit_data[-trainIndex,]\n\n#2. Create a naive bayes model on the dataset. Set \n# Laplace equal to 1. What is the accuracy of the model? (7)\nlibrary(e1071)\n\nmodel <- naiveBayes(default ~ ., data = credit_training, laplace = 1)\ntest_predict <- predict(model, newdata = credit_testing)\nconfusionMatrix(test_predict, credit_testing$default)\n# The accuracy is 0.741\n\n#3. Plot the ROC curve, make sure you have the colors of the\n# thresholds on the curve. Give explanation to the coloring of\n# the curve: what does it show?? What is the AUC? (7)\ntest_predict_prob <- predict(model, newdata = credit_testing, type = \"raw\")\nlibrary(ROCR)\n# Will default - positive case\np_test_will_default <- prediction(test_predict_prob[,2], credit_testing$default, label.ordering = c(\"0\", \"1\"))\nperf_will_default <- performance(p_test_will_default, 'tpr', 'fpr')\nplot(perf_will_default,colorize = TRUE)\nauc <- performance(p_test_will_default, 'auc')@y.values\nauc\n# The AUC is 0.7208738\n\n#4. Given that someone defaulted, what is the probability that\n# he/she has postgarduate degree? (7)\nmodel\n# According to the model, the probability is 0.01315789\n\n\n#5.Take any of the classification methods that we studied so\n# far and build a model using it. Compare that model with the\n# Naive Bayes model. Which one does better? Comment. (7)\n\n# I am choosing the logistic regression method\nmodel2 <- glm(default~ ., data = credit_training, family =\"binomial\")\n\nmodel2_predict <- predict(model2, newdata=credit_testing, type=\"response\")\n\n#If prob > 0.5, then consider defaulted\none_zero_labels <- ifelse(model2_predict > 0.5, '1', '0')\n\nconfusionMatrix(one_zero_labels, credit_testing$default, positive='1')\n# The accuracy is 0.7986 which is higher than for the naive-bayes approach.\n# The logistic regression performs better.\n\n#6. Load the scoring dataset into R. Our goal will be to give\n# credit scores (defualting probabilities) to the potential\n# customers. Predict the scores with the Naive Bayes model. (8)\nscoring_data <- read.csv(file=\"Homework7/data/Scoring.csv\", header = TRUE)\nscoring_predict <- predict(model, newdata = scoring_data, type=\"raw\")\nscoring_data$default <- scoring_predict[,2]\n\n#7. Identify the top 25% of customers that are least risky.\n# Describe them with the variables you have in the scoring dataset.(7) \ntop_25_least_risky <- head(scoring_data[order(scoring_data$default, decreasing= FALSE),], n = nrow(scoring_data)/4)\naverage_age <- mean(top_25_least_risky$age)\n# The average age is 41 years\naverage_income <- mean(top_25_least_risky$income)\n# The average income is 54 000\ntable(top_25_least_risky$ed)\n# 36 people who did not complete high school\n# 1 person with high school degree\naverage_cred_debt <- mean(top_25_least_risky$creddebt)\n# The average credit card debt is 1098\ndebt_to_income_ratio_average <- mean(top_25_least_risky$debtinc)\n# The average debt to income ratio is 7.727027\nother_debt_average <- mean(top_25_least_risky$othdebt)\n# The average for other debt is 2830\n\n# Bonus point\n#8. Compare top 25% of risky customers (Quartile 4) with bottom 25% of risky customers (Quartile 1). \n# What are the main differences you see? Generate 1-2 tables and graphs for the analysis. (10 points)\nbottom_25_risky <- tail(scoring_data[order(scoring_data$default, decreasing= FALSE),], n = nrow(scoring_data)/4)\naverage_bottom_age <- mean(bottom_25_risky$age)\n# The average age is 36 years\naverage_bottom_income <- mean(bottom_25_risky$income)\n# The average income is 79 000\ntable(bottom_25_risky$ed)\nhist(bottom_25_risky$ed)\n# Mostly we have people with college degree (14) and people with postgraduate degree (11) \nbottom_average_cred_debt <- mean(bottom_25_risky$creddebt)\n# The average credit card debt is 3472 (3 times more than for the least risky people)\nbottom_debt_to_income_ratio_average <- mean(bottom_25_risky$debtinc)\n# The average debt to income ratio is 12.96316 which is much higher than for least risky people\nbottom_other_debt_average <- mean(bottom_25_risky$othdebt)\n# The average for other debt is 5520 which is approximately 2 times higher than for the least risky people\n\n",
    "created" : 1479054526749.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4032644528",
    "id" : "85F610CE",
    "lastKnownWriteTime" : 1479054518,
    "last_content_update" : 1479054518,
    "path" : "C:/Users/markh/Desktop/Homework7_Sasun_Grigoryan.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}