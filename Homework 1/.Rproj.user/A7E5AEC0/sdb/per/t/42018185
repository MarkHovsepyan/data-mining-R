{
    "collab_server" : "",
    "contents" : "#----Homework 1----\n# For your homework you will need two datasets: Movies and Employee Attrition.\n# Please load them into R so that you can start working on them.\n# Make sure you provide enough description for your findings whenever question asks\n# for that. Feel free to express your thoughts, use your own words.\n# Write your code right below the questions.\n# Submit your R script on the moodle.\n# The code should be written in a way that I will be able to open and run it\n# on my computer without getting any errors.\n# For the upcoming questions, use movies database.\n\nload(\"Movies.rda\")\n\n#libraries to use\nlibrary(ggplot2)\nlibrary(plyr)\n\n# 1.What are the earliest and latest years for which we have a movie in the dataset? (1 point)\n\nrange(movies$Year) \n#min: 1920, max: 2016\n\n# 2.Create distribution of movies by years. What does this tell you? (1 point)\n\nqplot( movies$Year, bins = (2016 - 1920) )\n\nyear_freq_table <- table(movies$Year)\nView(year_freq_table)\nwhich.max(year_freq_table) # 2006\nwhich.min(year_freq_table) # 1920\nmean( movies$Year )   # 2002.988\nmedian( movies$Year ) # 2005\n\n#We can conclude that the least number of movies was created in 1920 (1 movie)\n#and that the most number of movies was created in 2006 (189 movies)\n\n# 3.Look at the average imdb rating for movies by year. Do you see any trend? (1 point)\n\nimdb_rating_avg <- aggregate(movies$imdbRating, by = list(movies$Year), FUN = \"mean\", na.rm = TRUE)\ncolnames(imdb_rating_avg) <- c( 'Year', 'Rating' )\nimdb_rating_avg$year[which.max( imdb_rating_avg$rating )]\nimdb_rating_avg$year[which.min( imdb_rating_avg$rating )]\n\nqplot(Year, Rating, data = imdb_rating_avg)\nplot(imdb_rating_avg$Year, imdb_rating_avg$Rating, type = 'o' )\n\n#after 1978 the average rating tends to get around 6.5 for all the following years\n# maximum avarage rating was in 1996 and minimum average rating was in 1920\n\n# 4.Create a boxplot for imdbRating and year, what do you see? (2 points)\n\nboxplot(movies$imdbRating~movies$Year)\n\n#the highest mean was nearly in 1970\n#after 2005 averages get closer to each other\n\n# 5.Create a new dataframe which is a subset of the old one.\n#The dataframe must contain only the years during which at least 10 movies were\n#created. Call the new dataframe movies2. (4 points)\n\nfrequency <- data.frame(table(unlist(movies$Year)))\ncolnames(frequency) <- c('Year', 'Frequency')\nmovie_years <- subset(frequency, subset = frequency$Frequency >= 10)\nmovies2 <- subset(movies, subset = movies$Year %in% movie_years$Year )\nView(movies2)\nstr(movies2)\n\n# For the upcoming questions use the movies2 dataframe.\n# 6.Create a histogram of imdbRating variable. What does it tell you? (1 point)\n\nhist(movies2$imdbRating)\n#ratings that occur most frequently are between 6 and 8 (nearly 7)\n\n# 7.Create histogram for a variable tomatoUserRating. What does it tell you?\n# Compare with histogram of imdbRating - any insights? (2 points)\n\nhist(movies2$imdbRating)\nhist(movies2$tomatoUserRating*2, add = T, col = rgb( 0.5, 0.2, 0.6, 0.7 )) \n#multiply by 2 as it is scaled in 5 point system \n#in tomatoUserRatings the most frequent ratings are between 2.5 and 3.5 (nearly 3)\n#both graphs are quite similar\n\n# 8.Metascore is a score given to the movie by the critics, while imdbRating\n# is a rating given by the users.\n# What is the meaning of correlation coefficient between these two variables?\n# (Hint: cor function will give an error if you dont handle missing values.\n# Look at the help for the function to fix that issue). (2 points)\n\ncor(movies2$imdbRating, movies2$Metascore, use = \"complete.obs\")\n#correlation is quite high (more than 0.7)\n\n# 9.Find the movie for which critics and users disagree the most. (Hint:\n# You may need to pay attention to the scales of the ratings) (2 points)\n\nX <- na.omit(movies2[,c('Metascore', 'imdbRating', 'Title')])\ndisagreement <- data.frame(abs(X$Metascore - 10 * X$imdbRating))\ncolnames(disagreement) <- c('Difference')\nX$Title[which.max(disagreement$Difference)]\n\n# 10. Create correlation matrix between all rating variables.\n# (Hint: Read the descriptions of all the variables to see which of them are ratings.) (1 point)\npairs(~Metascore+imdbRating+tomatoRating+tomatoUserRating+tomatoMeter+tomatoUserMeter, data = movies2) #plot\ncor(movies2[,c(\"Metascore\",\"imdbRating\", \"tomatoRating\", \"tomatoUserRating\", \"tomatoMeter\", \"tomatoUserMeter\")], use = \"complete.obs\") #table\n\n# 11.Do your own research and explain the meanings of the signs of \n# correlation  coefficients.(2 points)\n\n# when sign is + and near 1 it means that correlation is significant\n# when cor() is 0 it means that there is no correlation\n# when sign is - and near -1 it means that the difference is high and one grows in the opposite direction of the other\n\n# 12.Create a new dataframe which will show mean \n# gross income generated for each year. Create a plot summarizing that data.\n# What trend do you see. Explain. (3 points)\n\nmovies_gross <- aggregate(movies2$gross, by = list(movies2$Year), FUN = \"mean\")\ncolnames(movies_gross) <- c(\"Year\", \"Gross\")\nmovies_gross$Year[which.max(movies_gross$Gross)] # max is 2016\nmovies_gross$Year[which.min(movies_gross$Gross)] # min is 1999\nqplot(Year, Gross, data = movies_gross)\n\n# until 1999 there is a decrease in gross and after 1999\n# there is an increase in gross\n# reached max in 2016\n\n# 13.What do you think, which variable is mostly correlated with the gross income.\n# Test your assumption using cor function. Did you guess correct? Elaborate. (2 points)\n\ncor(movies2$gross, movies2$imdbRating, use = \"complete.obs\")\ncor(movies2$gross, movies2$budget, use = \"complete.obs\")\ncor(movies2$gross, movies2$tomatoUserRating, use = \"complete.obs\")\ncor(movies2$gross, movies2$imdbVotes, use = \"complete.obs\") #this is the highest correlation\n\n# 14.Which movie director has the highest average imdbRating? Is his average gross\n# also the highest. Give your thoughts on this topic.(Hint: you might find useful\n# the phenomenon of time value of money). (3 points)\n\nmovies_direct_rating <- aggregate(movies2$imdbRating, by = list(movies2$director_name), FUN = \"mean\")\nmovies_direct_gross <- aggregate(movies2$gross, by = list(movies2$director_name), FUN = \"mean\")\ncolnames(movies_direct_rating) <- c( 'Name', 'Rating' )\ncolnames(movies_direct_gross) <- c( 'Name', 'Gross' )\nmax(movies_direct_rating$Rating, na.rm = TRUE)\nmovies_direct_rating[which.max(movies_direct_rating$Rating),]\nmax(movies_direct_gross$Gross, na.rm = TRUE)\nmovies_direct_gross[which.max(movies_direct_gross$Gross),]\n\n# highest average rating has Tony Kaye (8.6)\n# however, highest gross averag has Lee Unkrich (414984497)\n\n# 15.Do your own analysis. Find something interesting (aggregate the data, \n# create plots, etc) (5 points)\n\nnums <- sapply( movies2, is.numeric )\ncor( movies2[ ,nums ], use='complete.obs' )\n\n#variables that I found out to be highly correlated:\n\nqplot(movies2$actor_1_facebook_likes, movies2$cast_total_facebook_likes)  # highly corelated\ncor(movies2$actor_1_facebook_likes, movies2$cast_total_facebook_likes)    # 0.9460783 (near 1)\nt.test(movies2$actor_1_facebook_likes, movies2$cast_total_facebook_likes) # p-value < 2.2e-16\n\nqplot(movies2$tomatoUserMeter, movies2$tomatoUserRating)                  # highly corelated\nt.test(movies2$tomatoUserMeter, movies2$tomatoUserRating)                 # p-value < 2.2e-16\n\nqplot(movies2$tomatoRating, movies2$Metascore)                            # highly corelated\nt.test(movies2$tomatoRating, movies2$Metascore)                           # p-value < 2.2e-16\n\n#I didn't manage to find other highly correlated variables\n\n# For the upcoming questions, use Employee attriotion database.\n# Factors are not set to this data, so R recognises them as integers.\n# For some problems you might need setting factors in order for R to operate correctly.\n# Make sure your variable types are set correctly before writing the code.\n\nload(\"Employee Attrition.rda\")\n\n# 16.Which position of employee (JobRole) is yielding maximum salary (HourlyRate) \n# on average? Representative of which position (JobRole) has the highest\n# hourly rate according to dataset? (2 points)\n\nattrition1 <- aggregate(attrition$HourlyRate, by = list(attrition$JobRole), FUN = \"mean\", na.rm = TRUE)\nattrition1[which.max(attrition1$x),]\n\n#Healthcare Representative is the position with the highest hourly income\n\n# 17.What is the correlation between the age of the employee and the hourly rate. Can you\n# say that the older is the employee, the higher he is earning? Explain. (1 point)\n\ncor(attrition$Age, attrition$HourlyRate)\nqplot(attrition$HourlyRate, attrition$Age)\n\n# 18.What is the age of the youngest and the oldest employees in the data? (1 point)\n\nrange(attrition$Age)\n# youngest: 18, oldest: 60\n\n\n# 19.Create a histogram of the employees by monthly income. What does it tell you? (1 points)\n\nhist(attrition$MonthlyIncome)\n\n# most of the employees' salary is in range of 2000 to 7000\n# highest are between 18000 and 20000\n\n# 20.Create a boxplot with Eduation and Percent Salary Hike. What do you see? (2 points)\n# Explain your findings.\n\nboxplot(attrition$Education~attrition$PercentSalaryHike)\n\n#PercentSalaryHike is not dependent on Education level\n\n# ----Hypothesis testing----\n# 21. Is there a difference between average Monthly Income of employees that churn\n# (leave the company) and those who stay within the company? (2 points)\n\nt.test(attrition$MonthlyIncome~attrition$Attrition)\n# p-value = 4.434e-13 it means they are correlated as p-value -> 0\n\n\n# 22.Is the decision of attriting from the company independent from the gender of\n# the employee? (2 points)\n\nchisq.test(attrition$Attrition, attrition$Gender)\n# there is no signficant relationship between them as p-value = 0.2906, but still there is small connection\n\n# 23. Choose any two variables that you want and conduct a test either for independence\n# or for differences in means. (2 points)\n\ncor(attrition$DistanceFromHome, attrition$DailyRate)        # -0.004985337 => no correlation which means they are independent\nchisq.test(attrition$DistanceFromHome, attrition$DailyRate) # p-value = 0.9608 => no correlation which means they are independent\nplot(attrition$DistanceFromHome, attrition$DailyRate)\n\n# 24. Do your own analysis for attrition data. Find something\n# interesting (aggregate the data, create plots, etc) (5 points)\n\nvariables <- sapply(attrition, is.numeric)\ncor(attrition[,variables], use = \"complete.obs\") # all correlations between variables\n\nboxplot(attrition$MonthlyIncome ~ attrition$JobLevel)             # as expected, they are highly correlated\nt.test(attrition$YearsInCurrentRole, attrition$YearsWithCurrManager)  # most of the workers that stay at the ssame role prefer to stay with the same manager\n\nboxplot(attrition$MonthlyIncome ~ attrition$Education)             # highly correlated\n\nt.test(attrition$Age, attrition$TrainingTimesLastYear)  # there is some correlation, which means age is affecting the training amount the employee gets\n",
    "created" : 1474661803366.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3656465761",
    "id" : "42018185",
    "lastKnownWriteTime" : 1474661258,
    "last_content_update" : 1474661258,
    "path" : "D:/Programming/R/Homework 1/Homework 1.R",
    "project_path" : "Homework 1.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}