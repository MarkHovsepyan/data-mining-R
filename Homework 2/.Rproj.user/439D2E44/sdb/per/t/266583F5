{
    "collab_server" : "",
    "contents" : "## importing PISA datasets\npisaTrain <- read.csv(\"pisa2009train.csv\") ## 3663 students\npisaTest <- read.csv(\"pisa2009test.csv\") ## 1570 students\n\nmean(pisaTrain$readingScore) ##497.9114\n\n## function to give a summary of missing values (count na's)\nlibrary(plyr)\nvalues_miss <- function(dataframe) lapply(dataframe,function(x)\ndata.frame(nmiss=sum(is.na(x))))\n\n## calling function on the pisaTrain\nvalues_miss(pisaTrain) ## var's with 0 na's are: grade, male, publicschool, urban, readingscore\n\n?na.omit\npisaTrain <- na.omit(pisaTrain)\npisaTest <- na.omit(pisaTest)\n\nnrow(pisaTrain) ## 2414\nnrow(pisaTest) ## 990\n\n## 6 and 7 here\n\nstr(pisaTrain)\nstr(pisaTest)\n\n?relevel\npisaTrain$raceeth <- relevel(pisaTrain$raceeth, \"White\")\npisaTest$raceeth <- relevel(pisaTest$raceeth, \"White\")\n\n## creating a model with readingScore as a dependent variable\npisa_model <- lm(readingScore~., data = pisaTrain)\n\nsummary(pisa_model)\n\nlibrary(memisc)\nmtable(pisa_model)\n\n## prediction training\npisa_predict <- predict(pisa_model, newdata = pisaTrain)\n## RMSE\nRMSE_train_pisa <- sqrt( mean( ( pisaTrain$readingScore - pisa_predict )^2 ) )\nRMSE_train_pisa ## 73.36555\n\n## prediction testing\npisa_predict <- predict(pisa_model, newdata = pisaTest)\n## RMSE\nRMSE_test_pisa <- sqrt( mean( ( pisaTest$readingScore - pisa_predict )^2 ) )\nRMSE_test_pisa ## 76.29079\n\n## problem 11\nlevels(pisaTrain$raceeth)\nstr(pisaTrain)\n\n## problem 13\nsummary(pisa_model) ## take alfa = 0.05\n\n## problem 14\npisa_baseline <- mean(pisaTrain$readingScore)\npisa_baseline\n\n## problem 15\n\npisa_SST = sum((mean(pisaTrain$readingScore) - pisaTest$readingScore)^2)\npisa_SST\n\n## problem 16\n\n\n\n## importing Flu dataset\nflu <- read.csv(\"Flu.csv\")\n## problem 17\nhist(Flu$ILI, xlab=\"ILI\", ylab=\"Frequemcy\") \n## when ILI goes down, the frequencies are decreasing\nsummary(flu$ILI)\n\n## problem 18\nlibrary(ggplot2)\ncor(log(flu$ILI), flu$Queries)\nqplot(log(ILI), Queries, data = flu)\n\n## problem 19\n\nflu_qplot <- qplot(log(flu$ILI), flu$Queries)\nflu_qplot + geom_abline(intercept=-2, slope=1)\n\n## problem 20\n\nFluTrend1 <- lm(log(flu$ILI) ~ flu$Queries)\nsummary(FluTrend1)\n\n##problem 21\nset.seed(20)\nsub <- sample(nrow(flu), floor(nrow(flu)*0.75))\nfluTrain <- flu[sub, ]\nfluTest <- flu[-sub,]\n\nflu_model <- lm(ILI ~ Queries,data = fluTrain)\nflu_pred <- predict(flu_model, newdata = fluTrain)\nflu_RMSE <- sqrt( mean( ( fluTrain$ILI - pisa_predict )^2 ) )\n\n## problem 22\n\nflu_baseline <- sqrt( mean ( ( fluTest$ILI - mean( fluTrain$ILI ) )^2) )\nflu_baseline\n\n## importing climate_change dataset\nclimate_change <- read.csv(\"climate_change.csv\")\n\n## creating train and test datasets\n?subset\nclimateTrain <- subset(climate_change, Year <= 2006)\nclimateTest <- climate_change[!(climate_change$Year %in% climateTrain$Year),]\n\n## problem 23\nclimate_fm <- formula(Temp ~ MEI+CO2+CH4+N2O+CFC.11+CFC.12+TSI+Aerosols-Year-Month)\n\nclimate_model <- lm(climate_fm, data = climateTrain)\n\nsummary(climate_model)\n\n\n## problem 24\ncor(climateTrain) #correlations between all variables\n\nnew_climate_fm <- formula(Temp~MEI+CO2+CH4+N2O+CFC.11+CFC.12+TSI+Aerosols)\nnew_climate_model <- lm(new_climate_fm, data = climateTrain)\nsummary(new_climate_model)\n\ncor( climateTrain )\nmodel_clim1 <- lm( Temp~MEI+N2O+TSI+Aerosols, data = climateTrain )\nsummary(model_clim1) # 0.02532 and Adj. R-squared:  0.7222 \n\n\n## problems 30 and 31\nlibrary(MASS)\n\nclimate_model1 <- lm(Temp~.-Year-Month, data = climateTrain)\nclimate_step <- stepAIC(climate_modelAIC, direction = 'both')\nclimate_step$anova\n\nclimate_stepModel <- lm(Temp~.-Year-Month-CH4, data = climateTrain)\nsummary(climate_stepModel) #Adj. R-squared:  0.7261\n\nstep_pred <- predict(climate_stepModel, newdata = climateTest)\nRMSE_step <- sqrt( mean( ( climateTest$Temp - step_pred )^2 ) )\nRMSE_step # 0.09522876\n",
    "created" : 1475511149352.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3304915753",
    "id" : "266583F5",
    "lastKnownWriteTime" : 1475529685,
    "last_content_update" : 1475529685608,
    "path" : "D:/Programming/R/Homework 2/Mark_Hovsepyan_Homework_2.R",
    "project_path" : "Mark_Hovsepyan_Homework_2.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}