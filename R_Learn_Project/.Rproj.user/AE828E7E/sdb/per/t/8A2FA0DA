{
    "collab_server" : "",
    "contents" : "load(\"voting_train.rda\") # train set\nload(\"voting_test.rda\") # test set\n\nlibrary(e1071)\nlibrary(caret)\nlibrary(caTools)\nlibrary(ROCR)\n\nmodel <- naiveBayes(Class~., data = Train, laplace = 1)\nsummary(model)\nnames(model)\n\nmodel$apriori # class frequencies\nmodel$tables  # conditional probabilities\nmodel$levels\nmodel$call\n\n# making predicitions\npred_test <- predict(model, newdata = Test)\nconfusionMatrix(pred_test, Test$Class) # confusion matrix\n\npred_test_prob <- predict(model, newdata = Test, type = \"raw\")\n\np_test1 <- prediction(pred_test_prob[, 1], Test$Class, label.ordering = c(\"republican\", \"democrat\"))\np_test2 <- prediction(pred_test_prob[, 2], Test$Class, label.ordering = c(\"democrat\", \"republican\"))\n\n# for positive = democrat\nperf <- performance(p_test1, \"tpr\", \"fpr\")\nplot(perf)\nperformance(p_test1, \"auc\")@y.values\n\n# for positive = republican\nperf <- performance(p_test2, \"tpr\", \"fpr\")\nplot(perf)\nperformance(p_test2, \"auc\")@y.values\n\n\n## SPAM\n\nspam <- read.csv(\"spam.csv\")\nspam$is_spam <- factor(spam$is_spam, levels = c(0, 1), labels = c(\"No\", \"Yes\"))\nis_spam <- spam$is_spam\n\nset.seed(2016)\nindex <- createDataPartition(spam$is_spam, p = .8, list = FALSE)                \nTrain <- spam[index,]\nTest <- spam[-index,]\n\nmodel_spam <- naiveBayes(is_spam~., data = Train, laplace = 1)\n\npred_test_spam <- predict(model_spam, newdata = Test)\nconfusionMatrix(pred_test_spam, Test$is_spam, positive = \"Yes\")\n\npred_test_prob_spam <- predict(model_spam, newdata = Test, type = \"raw\")\n\np_test_spam <- prediction(pred_test_prob_spam[, 1], Test$is_spam, label.ordering = c(\"Yes\", \"No\"))\n\nperf <- performance(p_test_spam, \"tpr\", \"fpr\")\nplot(perf)\nperformance(p_test_spam, \"auc\")@y.values\n\n\n",
    "created" : 1478075819357.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3556381209",
    "id" : "8A2FA0DA",
    "lastKnownWriteTime" : 1478078418,
    "last_content_update" : -2147483648,
    "path" : "F:/R_Learn_Project/Bayes_prediction.R",
    "project_path" : "Bayes_prediction.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}